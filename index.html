<!doctype html>
<html lang=en-US>
<meta charset=utf-8>
<title>Sweet Mastermind</title>
<link rel=stylesheet href=styles.css>

<div id=stage></div>
<div id=help-tip>Press ? for help</div>

<script type=text/template id=game-tpl>
  <div id=game>
    {{^gameOver}}
    <p class=status-msg>
      The code is made from `{{pool}}` characters.
      Trial {{1 + trials.length}} of {{maxTrials}}.
    </p>
    {{/gameOver}}

    {{#gameOver}}
    <p class='game-over-msg {{won ? "won" : "lost"}}'>
      Game Over.{{#won}} You won in {{trials.length}} trials!{{/won}}{{^won}} You lost. Secret is {{secret}}.{{/won}}
    </p>
    {{/gameOver}}

    <table>
      {{#trials}}
      <tr>
        {{#input}}<td class=peg>{{.}}</td>{{/input}}
        <td class=feedback>
          {{#dummyArray(blacks)}}● {{/blacks}}
          {{#dummyArray(whites)}}○ {{/whites}}
        </td>
      </tr>
      {{/trials}}
      {{^gameOver}}
      <tr>
        {{#currentInput:i}}<td class='peg {{currentIndex == i ? "active" : ""}}'
          >{{.}}</td>{{/currentInput}}
        <td>
          <button class=check-btn on-click=check disabled='{{!checkable}}'>↵ Check!</button>
        </td>
      </tr>
      {{/gameOver}}
    </table>
  </div>
</script>

<script type=text/template id=modal-tpl>
  <div class=modal-bg on-click=bg-click intro=fadeIn outro=fadeOut>
    <div class=modal>{{>content}}</div>
  </div>
</script>

<script type=text/template id=new-game-tpl>
  <header>
    <button on-click=close class=close-btn>× ESC</button>
    New game
  </header>
  <div on-hotkey=hotkey class=body>
    <label>
      <span>Range</span>
      <input type=range value='{{range}}' min='{{size+1}}' max=16>
      <span>{{range}}</span>
    </label>
    <label>
      <span>Code size</span>
      <input type=range value='{{size}}' min=3 max=6>
      <span>{{size}}</span>
    </label>
    <label>
      <span>Max trials</span>
      <input type=range value='{{maxTrials}}' min=6 max=20>
      <span>{{maxTrials}}</span>
    </label>
    <button class=new-btn on-click=new-game>↵ Start new game</button>
  </div>
</script>

<script type=text/template id=help-tpl>
  <header>
    <button on-click=close class=close-btn>× ESC</button>
    Sweet Mastermind
  </header>
  <div class=body>
    <p>This is a heavily keyboard-focused mastermind game implementation I created
      because all the others I found had a lot of distracting things.</p>
    <p>The app is powered by <a href='http://ractivejs.org'>Ractive.js</a> library
      and colors from the <a href='http://ethanschoonover.com/solarized'>Solarized</a>
      project.</p>
    <h3>Hotkeys</h3>
    <table class=hotkey-table>
      <tr>
        <td>?</td>
        <td>Show this help popup</td>
      </tr>
      <tr>
        <td>0-9 a-f</td>
        <td>Set value of active cell</td>
      </tr>
      <tr>
        <td>&larr; &rarr;</td>
        <td>Move active cell</td>
      </tr>
      <tr>
        <td>Backspace</td>
        <td>Empty the cell left of active cell</td>
      </tr>
      <tr>
        <td>↵ Enter</td>
        <td>Check code, if applicable</td>
      </tr>
      <tr>
        <td>n</td>
        <td>Start new game</td>
      </tr>
      <tr>
        <td>× ESC</td>
        <td>Close any open popup</td>
      </tr>
    </table>
  </div>
</script>

<script src=Ractive.min.js></script>
<script src=app.js></script>
